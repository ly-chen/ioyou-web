(this["webpackJsonpreact-firebase-ts-boilerplate"]=this["webpackJsonpreact-firebase-ts-boilerplate"]||[]).push([[0],{118:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(29),c=a.n(o),l=a(6),i=a.n(l),s=a(10),u=a(2),d=a(55),m=a(17),p="/",v="/signup",h="/login",f="/new",g="/user/:username",b="/post/:postid",E=a(16),O=Object(n.createContext)({}),y=function(){return Object(n.useContext)(O)},j=a(83),k=a(38),x=a.n(k),w=(a(102),a(103),a(105),{apiKey:"AIzaSyBJ9makgflmK4lFIt7Wc3HHW8qS8WiYz4A",authDomain:"ioyou-71889.firebaseapp.com",databaseURL:"https://ioyou-71889.firebaseio.com",projectId:"ioyou-71889",messagingSenderId:"193251044264"}),S=a(11),C=a(123),T=a(133),L=a(85),B=a(86),_=a(124),N=a(125),P=a(71),I=a(132),R=a(94),z=a(130),G=a(126),A=a(131),M=a(127),H=a(134),q=a(128),F=Object(n.createContext)({auth:{},initializing:!0}),D=function(){return Object(n.useContext)(F)},W=a(70),U=a.n(W),K=function(){var e=y(),t=D(),a=Object(n.useState)([]),o=Object(u.a)(a,2),c=o[0],l=o[1],d=Object(n.useState)([]),m=Object(u.a)(d,2),p=m[0],v=m[1],h=Object(n.useState)([]),f=Object(u.a)(h,2),g=f[0],b=f[1],O=Object(n.useState)([]),j=Object(u.a)(O,2),k=j[0],x=j[1],w=Object(n.useState)(void 0),F=Object(u.a)(w,2),W=F[0],K=F[1],Q=Object(n.useState)(null),Y=Object(u.a)(Q,2),V=Y[0],J=Y[1],X=Object(n.useState)(!1),Z=Object(u.a)(X,2),$=Z[0],ee=Z[1],te=Object(n.useState)(!1),ae=Object(u.a)(te,2),ne=ae[0],re=ae[1],oe=Object(n.useState)(!1),ce=Object(u.a)(oe,2),le=ce[0],ie=ce[1],se=Object(n.useState)(!1),ue=Object(u.a)(se,2),de=ue[0],me=ue[1],pe=Object(n.useState)(0),ve=Object(u.a)(pe,2),he=ve[0],fe=ve[1],ge=Object(n.useState)(null),be=Object(u.a)(ge,2),Ee=be[0],Oe=be[1],ye=Object(n.useState)(null),je=Object(u.a)(ye,2),ke=je[0],xe=je[1],we=Object(n.useState)(null),Se=Object(u.a)(we,2),Ce=Se[0],Te=Se[1],Le=Object(n.useState)(null),Be=Object(u.a)(Le,2),_e=Be[0],Ne=Be[1],Pe=Object(n.useState)("timestamp.seconds"),Ie=Object(u.a)(Pe,2),Re=Ie[0],ze=Ie[1],Ge=Object(n.useState)("timestamp.seconds"),Ae=Object(u.a)(Ge,2),Me=Ae[0],He=Ae[1],qe=Object(n.useState)("timestamp.seconds"),Fe=Object(u.a)(qe,2),De=Fe[0],We=Fe[1],Ue=Object(n.useState)("timestamp.seconds"),Ke=Object(u.a)(Ue,2),Qe=Ke[0],Ye=Ke[1],Ve=Object(n.useState)([]),Je=Object(u.a)(Ve,2),Xe=Je[0],Ze=Je[1],$e=Object(n.useState)([]),et=Object(u.a)($e,2),tt=et[0],at=et[1],nt=Object(n.useState)(!1),rt=Object(u.a)(nt,2),ot=rt[0],ct=rt[1],lt=Object(n.useState)(""),it=Object(u.a)(lt,2),st=it[0],ut=it[1],dt=Object(n.useState)(""),mt=Object(u.a)(dt,2),pt=mt[0],vt=mt[1],ht=Object(n.useState)(""),ft=Object(u.a)(ht,2),gt=ft[0],bt=ft[1],Et=Object(n.useState)(!1),Ot=Object(u.a)(Et,2),yt=Ot[0],jt=Ot[1],kt=Object(n.useState)(!1),xt=Object(u.a)(kt,2),wt=xt[0],St=xt[1],Ct=Object(n.useState)(!1),Tt=Object(u.a)(Ct,2),Lt=Tt[0],Bt=Tt[1],_t=function(){var a=Object(s.a)(i.a.mark((function a(){var n,r,o,c,l;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.db.collection("users").doc(null===(n=t.auth)||void 0===n?void 0:n.uid).get();case 3:return o=a.sent,console.log("user = ",o.data()),c=o.data(),J(c),(null===c||void 0===c?void 0:c.upvoted)&&Ze(null===c||void 0===c?void 0:c.upvoted),(null===c||void 0===c?void 0:c.downvoted)&&at(null===c||void 0===c?void 0:c.downvoted),l=null===(r=o.data())||void 0===r?void 0:r.actives,console.log("channelList = ",l),console.log("object.keys() = ",Object.keys(l).filter((function(e){return 1==l[e]}))),a.abrupt("return",Object.keys(l).filter((function(e){return 1==l[e]})));case 15:a.prev=15,a.t0=a.catch(0),console.log(a.t0);case 18:case"end":return a.stop()}}),a,null,[[0,15]])})));return function(){return a.apply(this,arguments)}}(),Nt=function(){var t=Object(s.a)(i.a.mark((function t(a,n,r,o,c,l,s,u,d){var m,p,v,h,f,g,b,O,y,j,k;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("lastCategory START = ",o),t.prev=1,v=[],h=e.db.collection("posts").orderBy(a,"desc"),f=null,console.log("subjects =",u),"all"!==n){t.next=23;break}if(console.log("lastCategory"),!o){t.next=17;break}return console.log("lastCategory = ",o),g="timestamp.seconds"==a?o.data.timestamp.seconds:o.data.upvotes,console.log("lastTime = ",g),t.next=14,h.startAfter(g).limit(10).get();case 14:f=t.sent,t.next=21;break;case 17:return t.next=19,h.limit(10).get();case 19:f=t.sent,console.log("tHIS POSTS = ",f.size);case 21:t.next=53;break;case 23:if("academic"!=n){t.next=29;break}if(void 0!=u&&0!=(null===u||void 0===u?void 0:u.length)){t.next=28;break}return f=null,s(!0),t.abrupt("return");case 28:h=h.where("bulletin","==",!1);case 29:if(!o){t.next=44;break}if(console.log("lastCategory 2 = ",o),b="timestamp.seconds"==a?o.data.timestamp.seconds:o.data.upvotes,console.log("lastTime = ",b),"bulletin"!=n){t.next=39;break}return t.next=36,h.startAfter(b).where("bulletin","==",!0).limit(10).get();case 36:f=t.sent,t.next=42;break;case 39:return t.next=41,h.startAfter(b).where("channels","array-contains-any",u).limit(10).get();case 41:f=t.sent;case 42:t.next=53;break;case 44:if("bulletin"!=n){t.next=50;break}return t.next=47,h.where("bulletin","==",!0).limit(10).get();case 47:f=t.sent,t.next=53;break;case 50:return t.next=52,h.where("channels","array-contains-any",u).limit(10).get();case 52:f=t.sent;case 53:if(!(null===(m=f)||void 0===m?void 0:m.empty)&&null!=f){t.next=57;break}return console.log("No matching documents"),s(!0),t.abrupt("return");case 57:null===(p=f)||void 0===p||p.forEach((function(e){v=[].concat(Object(E.a)(v),[{id:e.id,data:e.data()}])})),O=v[v.length-1],c(O),y=0;case 61:if(!(y<v.length)){t.next=70;break}return j=v[y],t.next=65,e.db.collection("comments").where("thread","==",j.id).get();case 65:k=t.sent,v[y]={id:j.id,data:j.data,numComments:k.size};case 67:y++,t.next=61;break;case 70:l(d?Object(E.a)(v):[].concat(Object(E.a)(r),Object(E.a)(v))),s(!0),t.next=77;break;case 74:t.prev=74,t.t0=t.catch(1),console.log(t.t0);case 77:case"end":return t.stop()}}),t,null,[[1,74]])})));return function(e,a,n,r,o,c,l,i,s){return t.apply(this,arguments)}}(),Pt=function(){var e=Object(s.a)(i.a.mark((function e(){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],!t.auth){e.next=5;break}return e.next=4,_t();case 4:a=e.sent;case 5:K(a),Nt("timestamp.seconds","all",c,Ee,Oe,l,ee,a,!1),Nt("timestamp.seconds","home",p,ke,xe,v,re,a,!1),Nt("timestamp.seconds","academic",g,Ce,Te,b,ie,a,!1),Nt("timestamp.seconds","bulletin",k,_e,Ne,x,me,a,!1),console.log("subjects = ",a);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){var e=.001*(new Date).getTime()>>0;fe(e),console.log(e),Pt()}),[t,e]);var It=function(){return r.a.createElement("div",{style:{paddingTop:15}},r.a.createElement(T.a,{style:{marginBottom:20}},r.a.createElement(T.a.Body,null,r.a.createElement(T.a.Title,null),r.a.createElement(T.a.Text,null),r.a.createElement(_.a,{animation:"border"}))),r.a.createElement(T.a,{style:{marginBottom:20}},r.a.createElement(T.a.Body,null,r.a.createElement(T.a.Title,null),r.a.createElement(T.a.Text,null),r.a.createElement(_.a,{animation:"border"}))),r.a.createElement(T.a,{style:{marginBottom:20}},r.a.createElement(T.a.Body,null,r.a.createElement(T.a.Title,null),r.a.createElement(T.a.Text,null),r.a.createElement(_.a,{animation:"border"}))),r.a.createElement(T.a,{style:{marginBottom:20}},r.a.createElement(T.a.Body,null,r.a.createElement(T.a.Title,null),r.a.createElement(T.a.Text,null),r.a.createElement(_.a,{animation:"border"}))),r.a.createElement(T.a,{style:{marginBottom:20}},r.a.createElement(T.a.Body,null,r.a.createElement(T.a.Title,null),r.a.createElement(T.a.Text,null),r.a.createElement(_.a,{animation:"border"}))))},Rt=function(a){return a.map((function(a){return r.a.createElement("div",{key:a.id,style:{paddingTop:15}},function(a){var n=he-a.data.timestamp.seconds,o="";if(n<120)o="about a minute ago";else if(n<3600)o="".concat(Math.floor(n/60)," minutes ago");else if(n<86400){var c=Math.floor(n/3600);o=1==c?"about an hour ago":"".concat(c," hours ago")}else{var l=Math.floor(n/86400);o=1==l?"yesterday":"".concat(l," days ago")}var i=function(){var e,t=null===(e=a.data.channels)||void 0===e?void 0:e.map((function(e){return r.a.createElement("p",{key:e},0==a.data.channels.indexOf(e)?"#".concat(e):", #".concat(e))}));return r.a.createElement("div",null,r.a.createElement(C.a,{style:{marginLeft:1}},t))},s=function(n){var r,o=[],c=[],l=-1,i=-1;if(console.log("userDoc = ",V),V.upvoted&&(l=(o=Xe).indexOf(a.id)),V.downvoted&&(i=(c=tt).indexOf(a.id)),console.log("upvoteIndex = ",l),console.log("upvoteList = ",o),console.log("downvoteIndex = ",i),console.log("downvoteList = ",c),r=a.data.upvotes?a.data.upvotes:0,n){var s;if(-1==l){var u;if(-1!=i)c.splice(i,1),e.db.collection("users").doc(null===(u=t.auth)||void 0===u?void 0:u.uid).update({downvoted:c}),r+=1;o=[].concat(Object(E.a)(o),[a.id]),console.log("upvoteList after adding = ",o),r+=1}else o.splice(l,1),console.log("upvoteList after splice = ",o),r-=1;e.db.collection("users").doc(null===(s=t.auth)||void 0===s?void 0:s.uid).update({upvoted:o}),e.db.collection("posts").doc(a.id).update({upvotes:r}),a.data.upvotes=r}else{var d;if(-1==i){var m;if(-1!=l)o.splice(l,1),e.db.collection("users").doc(null===(m=t.auth)||void 0===m?void 0:m.uid).update({upvoted:o}),r-=1;c=[].concat(Object(E.a)(c),[a.id]),console.log("downvoteList after adding = ",c),r-=1}else c.splice(i,1),console.log("downvoteList after splice = ",c),r+=1;e.db.collection("users").doc(null===(d=t.auth)||void 0===d?void 0:d.uid).update({downvoted:c}),e.db.collection("posts").doc(a.id).update({upvotes:r}),a.data.upvotes=r}o&&Ze(o),c&&at(c)};return r.a.createElement(T.a,{style:{marginBottom:20}},r.a.createElement(T.a.Body,null,a.data.bulletin?r.a.createElement("div",null,r.a.createElement("a",{href:"/post/".concat(a.id)},r.a.createElement(T.a.Title,null,a.data.title)),r.a.createElement(T.a.Subtitle,null,i())):r.a.createElement(C.a,null,r.a.createElement(L.a,null,r.a.createElement("a",{href:"/post/".concat(a.id)},r.a.createElement(T.a.Title,null,a.data.title)),r.a.createElement(T.a.Subtitle,null,i())),r.a.createElement(L.a,{xs:3,md:2,style:{textAlign:"center"}},r.a.createElement(T.a,{bg:"light"},a.data.bounty<=0?r.a.createElement(T.a.Title,{style:{paddingTop:10}},"Claimed"):r.a.createElement(T.a.Title,{style:{paddingTop:10}},a.data.bounty," cr.")))),r.a.createElement(T.a.Text,{className:U.a.fontLess}," ",a.data.desc),r.a.createElement(T.a.Text,{className:U.a.fontLess,style:{paddingTop:10}},r.a.createElement(B.a,{disabled:!t.auth,size:"sm",active:Xe.includes(a.id),variant:"outline-primary",onClick:function(){s(!0),ct(!ot)}},"\u25b2")," ","\xa0",a.data.upvotes?a.data.upvotes:0," ","\xa0",r.a.createElement(B.a,{disabled:!t.auth,size:"sm",active:tt.includes(a.id),variant:"outline-danger",onClick:function(){s(!1),ct(!ot)}},"\u25bc")," ","\xa0",1==a.numComments?r.a.createElement("a",{href:"/post/".concat(a.id)},a.numComments," comment"):r.a.createElement("a",{href:"/post/".concat(a.id)},a.numComments," comments")," "," - posted by ",r.a.createElement("a",{href:"/user/".concat(a.data.authorName)},"@".concat(a.data.authorName))," - ",o," - ","\xa0",r.a.createElement(B.a,{disabled:!t.auth,size:"sm",variant:"outline-danger",onClick:function(){vt(a.data.authorName),bt(a.id),Bt(!0)}},"\u2690"))))}(a))}))},zt=function(e,t,a,n,o,c,l){var u=function(){var a=Object(s.a)(i.a.mark((function a(r){return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n(null),o([]),c(!1),a.next=5,Nt(r,e,t,null,n,o,c,W,!0);case 5:return a.next=7,l(r);case 7:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();return r.a.createElement(N.a,{id:"sort",title:"bounty"==a?"Highest Bounty":"Most Recent",variant:"light",style:{paddingTop:15}},r.a.createElement(P.a.Item,{active:"timestamp.seconds"==a,onClick:Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("timestamp.seconds"!=a){e.next=4;break}return e.abrupt("return");case 4:u("timestamp.seconds");case 5:case"end":return e.stop()}}),e)})))},"Most Recent"),r.a.createElement(P.a.Item,{active:"bounty"==a,onClick:Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("bounty"!=a){e.next=4;break}return e.abrupt("return");case 4:u("bounty");case 5:case"end":return e.stop()}}),e)})))},"Highest Bounty"),r.a.createElement(P.a.Item,{active:"upvotes"==a,onClick:function(){"upvotes"!=a&&u("upvotes")}},"Top Rated"))};return r.a.createElement("div",null,r.a.createElement(I.a,{bg:"light",variant:"light"},r.a.createElement(I.a.Brand,{href:"/"}," ","ioyou"),r.a.createElement(R.a,{className:"ml-auto"},t.auth?r.a.createElement("div",null,r.a.createElement(B.a,{variant:"light",onClick:Object(s.a)(i.a.mark((function a(){var n,r,o,c;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.db.collection("users").doc(null===t||void 0===t||null===(n=t.auth)||void 0===n?void 0:n.uid).get();case 2:o=a.sent,c=null===o||void 0===o||null===(r=o.data())||void 0===r?void 0:r.username,window.location.href="/user/".concat(c);case 5:case"end":return a.stop()}}),a)}))),style:{marginRight:10}},"Profile"),r.a.createElement(B.a,{href:"/new",variant:"outline-dark",style:{marginRight:10}},"Post"),r.a.createElement(B.a,{variant:"light",onClick:function(){e.doSignOut(),window.location.reload()}},"Sign Out")):r.a.createElement("div",null,r.a.createElement(B.a,{variant:"outline-dark",href:"/login",style:{marginRight:10}},"log in"),r.a.createElement(B.a,{variant:"light",href:"/signup"},"sign up")))),r.a.createElement(z.a,{show:Lt,onHide:function(){Bt(!1),St(!1),ut("")}},r.a.createElement(z.a.Header,{closeButton:!0},r.a.createElement(z.a.Title,null,"Report @",pt)),r.a.createElement(z.a.Body,null,"Let us know if this user is violating community agreements as outlined in our terms of service. Thanks!"),r.a.createElement(z.a.Footer,null,r.a.createElement(G.a,null,r.a.createElement(A.a.Control,{as:"textarea",placeholder:"What's the reason for reporting this user?",rows:3,onChange:function(e){ut(e.target.value)},value:st})),yt?r.a.createElement(B.a,{disabled:!0,variant:"danger"},r.a.createElement(_.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})):wt?r.a.createElement(B.a,{disabled:!0,variant:"danger"},"Thanks! You can close this window."):r.a.createElement(B.a,{variant:"danger",onClick:Object(s.a)(i.a.mark((function e(){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return jt(!0),e.next=3,Object(S.functions)().httpsCallable("createReport")({post:gt,reportMessage:st,submittedBy:null===(a=t.auth)||void 0===a?void 0:a.uid,timestamp:S.firestore.Timestamp.now()}).then((function(){jt(!1),St(!0)}));case 3:case"end":return e.stop()}}),e)})))},"Report"))),r.a.createElement(M.a,{className:U.a.paddingTop},r.a.createElement(C.a,null,r.a.createElement(L.a,null,r.a.createElement("h1",{style:{paddingLeft:22,paddingBottom:15}},"Feed")),r.a.createElement(L.a,null)),r.a.createElement(H.a,{defaultActiveKey:t.auth?"Home":"All",id:"feed-nav"},r.a.createElement(q.a,{eventKey:"All",title:"All"},zt("all",c,Re,Oe,l,ee,ze),c[0]?r.a.createElement("div",null,Rt(c),$?r.a.createElement(B.a,{variant:"light",onClick:function(){ee(!1),Nt(Re,"all",c,Ee,Oe,l,ee,[],!1)}},"Load more"):r.a.createElement(B.a,{disabled:!0,variant:"light"},r.a.createElement(_.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}))):$?r.a.createElement(T.a,{style:{marginTop:15}},r.a.createElement(T.a.Body,null,r.a.createElement(T.a.Text,null,"No new posts."))):It()),r.a.createElement(q.a,{eventKey:"Home",title:"Home"},zt("home",p,Me,xe,v,re,He),p[0]?r.a.createElement("div",null,Rt(p),ne?r.a.createElement(B.a,{variant:"light",onClick:function(){re(!1),Nt(Me,"home",p,ke,xe,v,re,W,!1)}},"Load more"):r.a.createElement(B.a,{disabled:!0,variant:"light"},r.a.createElement(_.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}))):ne?t.auth?r.a.createElement(T.a,{style:{marginTop:15}},r.a.createElement(T.a.Body,null,r.a.createElement(T.a.Text,null,"No new posts. Subscribe to more channels in your Profile page!"))):r.a.createElement(T.a,{style:{marginTop:15}},r.a.createElement(T.a.Body,null,r.a.createElement(T.a.Text,null,"Create an account to subscribe to specific channels."))):It()),r.a.createElement(q.a,{eventKey:"Academic",title:"Academic"},zt("academic",g,De,Te,b,ie,We),g[0]?r.a.createElement("div",null,Rt(g),le?r.a.createElement(B.a,{variant:"light",onClick:function(){ie(!1),Nt(De,"academic",g,Ce,Te,b,ie,W,!1)}},"Load more"):r.a.createElement(B.a,{disabled:!0,variant:"light"},r.a.createElement(_.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}))):le?t.auth?r.a.createElement(T.a,{style:{marginTop:15}},r.a.createElement(T.a.Body,null,r.a.createElement(T.a.Text,null,"Subscribe to channels in your Profile page."))):r.a.createElement(T.a,{style:{marginTop:15}},r.a.createElement(T.a.Body,null,r.a.createElement(T.a.Text,null,"Create an account to subscribe to specific channels."))):It()),r.a.createElement(q.a,{eventKey:"Bulletin",title:"Bulletin"},zt("bulletin",k,Qe,Ne,x,me,Ye),k[0]?r.a.createElement("div",null,Rt(k),de?r.a.createElement(B.a,{variant:"light",onClick:function(){me(!1),Nt(Qe,"bulletin",k,_e,Ne,x,me,W,!1)}},"Load more"):r.a.createElement(B.a,{disabled:!0,variant:"light"},r.a.createElement(_.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}))):de?r.a.createElement(T.a,{style:{marginTop:15}},r.a.createElement(T.a.Body,null,r.a.createElement(T.a.Text,null,"No new posts."))):It()))))},Q=a(42),Y=a.n(Q),V=function(){var e=Object(m.f)().username,t=y(),a=D(),o=Object(n.useState)(null),c=Object(u.a)(o,2),l=c[0],d=c[1],p=Object(n.useState)(""),v=Object(u.a)(p,2),h=v[0],f=v[1],g=Object(n.useState)(!0),b=Object(u.a)(g,2),O=b[0],j=b[1],k=Object(n.useState)(!1),x=Object(u.a)(k,2),w=x[0],z=x[1],G=Object(n.useState)(null),A=Object(u.a)(G,2),H=A[0],q=A[1],F=Object(n.useState)([]),W=Object(u.a)(F,2),U=W[0],K=W[1],Q=Object(n.useState)([]),V=Object(u.a)(Q,2),J=V[0],X=V[1],Z=Object(n.useState)(!1),$=Object(u.a)(Z,2),ee=$[0],te=$[1],ae=Object(n.useState)(!1),ne=Object(u.a)(ae,2),re=ne[0],oe=ne[1],ce=Object(n.useState)(!1),le=Object(u.a)(ce,2),ie=le[0],se=le[1],ue=Object(n.useState)(!1),de=Object(u.a)(ue,2),me=de[0],pe=de[1],ve=Object(n.useState)(!1),he=Object(u.a)(ve,2),fe=he[0],ge=he[1],be=Object(n.useState)(null),Ee=Object(u.a)(be,2),Oe=Ee[0],ye=Ee[1],je=Object(n.useState)(!1),ke=Object(u.a)(je,2),xe=ke[0],we=ke[1],Se=Object(n.useState)(0),Ce=Object(u.a)(Se,2),Te=Ce[0],Le=Ce[1],Be=Object(n.useState)(null),_e=Object(u.a)(Be,2),Ne=_e[0],Pe=_e[1],Ie=Object(n.useState)("timestamp.seconds"),Re=Object(u.a)(Ie,2),ze=Re[0],Ge=Re[1],Ae=Object(n.useState)({}),Me=Object(u.a)(Ae,2),He=Me[0],qe=Me[1],Fe=function(){var e=Object(s.a)(i.a.mark((function e(a,n,r,o){var c,l,s,u,d,m,p,v;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=[],l=t.db.collection("posts").where("author","==",n).orderBy(a,"desc"),r&&(console.log("lastPost = ",r),s="timestamp.seconds"==a?r.data.timestamp.seconds:r.data.upvotes,console.log("lastTime = ",s),l=l.startAfter(s)),e.next=6,l.limit(10).get();case 6:if(!(u=e.sent).empty&&null!=u){e.next=11;break}return console.log("No matching documents"),we(!0),e.abrupt("return");case 11:u.forEach((function(e){c=[].concat(Object(E.a)(c),[{id:e.id,data:e.data()}])})),d=0;case 13:if(!(d<c.length)){e.next=22;break}return m=c[d],e.next=17,t.db.collection("comments").where("thread","==",m.id).get();case 17:p=e.sent,c[d]={id:m.id,data:m.data,numComments:p.size};case 19:d++,e.next=13;break;case 22:if(v=c[c.length-1],Pe(v),!o){e.next=29;break}return e.next=27,ye([].concat(Object(E.a)(o),Object(E.a)(c)));case 27:e.next=31;break;case 29:return e.next=31,ye(c);case 31:console.log("docList = ",c),we(!0),e.next=39;break;case 35:e.prev=35,e.t0=e.catch(0),console.log(e.t0),we(!0);case 39:case"end":return e.stop()}}),e,null,[[0,35]])})));return function(t,a,n,r){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){var t=.001*(new Date).getTime()>>0;(Le(t),function(){var t=Object(s.a)(i.a.mark((function t(){var a,n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(S.firestore)().collection("users").where("username","==",e).limit(1).get();case 2:if(!(a=t.sent).empty){t.next=8;break}console.log("empty"),j(!1),t.next=20;break;case 8:return t.next=10,a.docs[0].id;case 10:return n=t.sent,f(n),t.next=14,a.docs[0].data();case 14:r=t.sent,d(r),qe(r.actives),r.actives&&((r.actives.French||r.actives.Mandarin||r.actives.Spanish||r.actives["Languages (General)"])&&se(!0),(r.actives.Biology||r.actives.Chemistry||r.actives.Physics||r.actives["Sciences (General)"])&&pe(!0),(r.actives.Psychology||r.actives.Sociology||r.actives["Social Sciences (General)"])&&ge(!0)),Fe("timestamp.seconds",n,Ne,Oe),j(!1);case 20:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()(),a.auth)&&function(){var t=Object(s.a)(i.a.mark((function t(){var n,r,o,c,l;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(S.firestore)().collection("users").doc(null===a||void 0===a||null===(n=a.auth)||void 0===n?void 0:n.uid).get();case 2:(null===(l=t.sent)||void 0===l||null===(r=l.data())||void 0===r?void 0:r.username)==e&&z(!0),q(l.data()),K(null===(o=l.data())||void 0===o?void 0:o.upvoted),X(null===(c=l.data())||void 0===c?void 0:c.downvoted);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()}),[a,t]);var De=function(e){var t=He;1==He[e]?(t[e]=!1,qe(t)):(t[e]=!0,qe(t))},We=function(e,n){var r,o=[],c=[],l=-1,i=-1;if(H.upvoted&&(l=(o=U).indexOf(n.id)),H.downvoted&&(i=(c=J).indexOf(n.id)),r=n.data.upvotes?n.data.upvotes:0,e){var s;if(-1==l){var u;if(-1!=i)c.splice(i,1),t.db.collection("users").doc(null===(u=a.auth)||void 0===u?void 0:u.uid).update({downvoted:c}),r+=1;o=[].concat(Object(E.a)(o),[n.id]),console.log("upvoteList after adding = ",o),r+=1}else o.splice(l,1),console.log("upvoteList after splice = ",o),r-=1;t.db.collection("users").doc(null===(s=a.auth)||void 0===s?void 0:s.uid).update({upvoted:o}),t.db.collection("posts").doc(n.id).update({upvotes:r}),n.data.upvotes=r}else{var d;if(-1==i){var m;if(-1!=l)o.splice(l,1),t.db.collection("users").doc(null===(m=a.auth)||void 0===m?void 0:m.uid).update({upvoted:o}),r-=1;c=[].concat(Object(E.a)(c),[n.id]),console.log("downvoteList after adding = ",c),r-=1}else c.splice(i,1),console.log("downvoteList after splice = ",c),r+=1;t.db.collection("users").doc(null===(d=a.auth)||void 0===d?void 0:d.uid).update({downvoted:c}),t.db.collection("posts").doc(n.id).update({upvotes:r}),n.data.upvotes=r}o&&K(o),c&&X(c)};return r.a.createElement("div",null,r.a.createElement(I.a,{bg:"light",variant:"light"},r.a.createElement(I.a.Brand,{href:"/"}," ","ioyou"),r.a.createElement(R.a,{className:"ml-auto"},a.auth?r.a.createElement("div",null,r.a.createElement(B.a,{variant:"light",onClick:Object(s.a)(i.a.mark((function e(){var n,r,o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.db.collection("users").doc(null===a||void 0===a||null===(n=a.auth)||void 0===n?void 0:n.uid).get();case 2:o=e.sent,c=null===o||void 0===o||null===(r=o.data())||void 0===r?void 0:r.username,window.location.href="/user/".concat(c);case 5:case"end":return e.stop()}}),e)}))),style:{marginRight:10}},"Profile"),r.a.createElement(B.a,{href:"/new",variant:"outline-dark",style:{marginRight:10}},"Post"),r.a.createElement(B.a,{variant:"light",onClick:function(){z(!1),t.doSignOut()}},"Sign Out")):r.a.createElement("div",null,r.a.createElement(B.a,{variant:"outline-dark",href:"/login",style:{marginRight:10}},"log in"),r.a.createElement(B.a,{variant:"light",href:"/signup"},"sign up")))),O?r.a.createElement(M.a,{className:Y.a.paddingTop},r.a.createElement(_.a,{style:{marginTop:30,marginLeft:30},animation:"border"})):l?r.a.createElement(M.a,{className:Y.a.paddingTop},r.a.createElement(T.a,null,r.a.createElement(T.a.Body,null,r.a.createElement(C.a,null,r.a.createElement(L.a,null,r.a.createElement("h2",null,"@",e),r.a.createElement("h2",null,l.name)),r.a.createElement(L.a,null,1==l.credits?r.a.createElement("h3",null,"1 credit"):r.a.createElement("h3",null,l.credits," credits"))),r.a.createElement("hr",null),r.a.createElement(C.a,{style:{paddingLeft:15}},r.a.createElement("h3",{style:{paddingRight:15}},"Channels"),w?ee?r.a.createElement(B.a,{variant:"primary",onClick:Object(s.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return te(!1),e.next=3,Object(S.firestore)().collection("users").doc(null===(t=a.auth)||void 0===t?void 0:t.uid).update({actives:He});case 3:case"end":return e.stop()}}),e)})))},"Save"):r.a.createElement(B.a,{variant:"outline-dark",onClick:function(){te(!0)}},"Edit"):r.a.createElement("div",null)),ee?r.a.createElement(C.a,{style:{paddingTop:15,paddingLeft:15}},r.a.createElement(B.a,{active:He.Arts,variant:"outline-dark",style:{marginRight:15,marginBottom:15},onClick:function(){De("Arts"),oe(!re)}},"Arts"),r.a.createElement(B.a,{active:He.Business,variant:"outline-dark",style:{marginRight:15,marginBottom:15},onClick:function(){De("Business"),oe(!re)}},"Business"),r.a.createElement(B.a,{variant:"outline-dark",active:He["Computer Science"],style:{marginRight:15,marginBottom:15},onClick:function(){De("Computer Science"),oe(!re)}},"Computer Science"),r.a.createElement(B.a,{variant:"outline-dark",active:He.Economics,style:{marginRight:15,marginBottom:15},onClick:function(){De("Economics"),oe(!re)}},"Economics"),r.a.createElement(B.a,{variant:"outline-dark",active:He.Finance,style:{marginRight:15,marginBottom:15},onClick:function(){De("Finance"),oe(!re)}},"Finance"),r.a.createElement(B.a,{variant:"outline-dark",active:He.History,style:{marginRight:15,marginBottom:15},onClick:function(){De("History"),oe(!re)}},"History"),r.a.createElement(B.a,{variant:"outline-dark",active:He.Humanities,style:{marginRight:15,marginBottom:15},onClick:function(){De("Humanities"),oe(!re)}},"Humanities"),r.a.createElement(N.a,{id:"lang",title:"Languages",variant:ie?"dark":"outline-dark",style:{marginRight:15,marginBottom:15}},r.a.createElement(P.a.Item,{active:He.French,onClick:function(){De("French"),oe(!re),He.French||He.Mandarin||He.Spanish||He["Languages (General)"]?se(!0):se(!1)}},"French"),r.a.createElement(P.a.Item,{active:He.Mandarin,onClick:function(){De("Mandarin"),oe(!re),He.French||He.Mandarin||He.Spanish||He["Languages (General)"]?se(!0):se(!1)}},"Mandarin"),r.a.createElement(P.a.Item,{active:He.Spanish,onClick:function(){De("Spanish"),oe(!re),He.French||He.Mandarin||He.Spanish||He["Languages (General)"]?se(!0):se(!1)}},"Spanish"),r.a.createElement(P.a.Item,{active:He["Languages (General)"],onClick:function(){De("Languages (General)"),oe(!re),He.French||He.Mandarin||He.Spanish||He["Languages (General)"]?se(!0):se(!1)}},"General")),r.a.createElement(B.a,{variant:"outline-dark",style:{marginRight:15,marginBottom:15},active:He.Mathematics,onClick:function(){De("Mathematics"),oe(!re)}},"Mathematics"),r.a.createElement(N.a,{id:"sci",title:"Sciences",variant:me?"dark":"outline-dark",style:{marginRight:15,marginBottom:15}},r.a.createElement(P.a.Item,{active:He.Biology,onClick:function(){De("Biology"),oe(!re),He.Biology||He.Chemistry||He.Physics||He["Sciences (General)"]?pe(!0):pe(!1)}},"Biology"),r.a.createElement(P.a.Item,{active:He.Chemistry,onClick:function(){De("Chemistry"),oe(!re),He.Biology||He.Chemistry||He.Physics||He["Sciences (General)"]?pe(!0):pe(!1)}},"Chemistry"),r.a.createElement(P.a.Item,{active:He.Physics,onClick:function(){De("Physics"),oe(!re),He.Biology||He.Chemistry||He.Physics||He["Sciences (General)"]?pe(!0):pe(!1)}},"Physics"),r.a.createElement(P.a.Item,{active:He["Sciences (General)"],onClick:function(){De("Sciences (General)"),oe(!re),He.Biology||He.Chemistry||He.Physics||He["Sciences (General)"]?pe(!0):pe(!1)}},"General")),r.a.createElement(N.a,{id:"lang",title:"Social Sciences",variant:fe?"dark":"outline-dark",style:{marginRight:15,marginBottom:15}},r.a.createElement(P.a.Item,{active:He.Psychology,onClick:function(){De("Psychology"),oe(!re),He.Psychology||He.Sociology||He["Social Sciences (General)"]?ge(!0):ge(!1)}},"Psychology"),r.a.createElement(P.a.Item,{active:He.Sociology,onClick:function(){De("Sociology"),oe(!re),He.Psychology||He.Sociology||He["Social Sciences (General)"]?ge(!0):ge(!1)}},"Sociology"),r.a.createElement(P.a.Item,{active:He["Social Sciences (General)"],onClick:function(){De("Social Sciences (General)"),oe(!re),He.Psychology||He.Sociology||He["Social Sciences (General)"]?ge(!0):ge(!1)}},"General")),r.a.createElement(B.a,{variant:"outline-dark",style:{marginRight:15,marginBottom:15},active:He.General,onClick:function(){De("General"),oe(!re)}},"General")):He?function(){var e=Object.entries(He).map((function(e){var t=Object(u.a)(e,2),a=t[0];t[1];return He[a]?"bulletin"==a?r.a.createElement("div",{key:a}):r.a.createElement(B.a,{key:a,active:!0,variant:"outline-dark",style:{marginRight:15,marginBottom:15}},a):r.a.createElement("div",{key:a})}));return r.a.createElement(C.a,{style:{paddingTop:15,paddingLeft:15}},e)}():r.a.createElement("div",null))),r.a.createElement("h2",{style:{paddingTop:50,paddingLeft:22,paddingBottom:15}},"Post History"),function(e){var t=function(){var e=Object(s.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Pe(null),ye(null),we(!1),e.next=5,Fe(t,h,null,null);case 5:Ge(t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(N.a,{id:"sort",title:"timestamp.seconds"==e?"Most Recent":"Top Rated",variant:"light",style:{paddingBottom:15}},r.a.createElement(P.a.Item,{active:"timestamp.seconds"==e,onClick:Object(s.a)(i.a.mark((function a(){return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if("timestamp.seconds"!=e){a.next=4;break}return a.abrupt("return");case 4:t("timestamp.seconds"),oe(!re);case 6:case"end":return a.stop()}}),a)})))},"Most Recent"),r.a.createElement(P.a.Item,{active:"upvotes"==e,onClick:Object(s.a)(i.a.mark((function a(){return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if("upvotes"!=e){a.next=4;break}return a.abrupt("return");case 4:t("upvotes"),oe(!re);case 6:case"end":return a.stop()}}),a)})))},"Top of All Time"))}(ze),Oe?r.a.createElement("div",null,Oe.map((function(e){return r.a.createElement("div",{key:e.id},function(e){var t=Te-e.data.timestamp.seconds,n="";if(t<120)n="about a minute ago";else if(t<3600)n="".concat(Math.floor(t/60)," minutes ago");else if(t<86400){var o=Math.floor(t/3600);n=1==o?"about an hour ago":"".concat(o," hours ago")}else{var c=Math.floor(t/86400);n=1==c?"yesterday":"".concat(c," days ago")}return r.a.createElement(T.a,{style:{marginBottom:20}},r.a.createElement(T.a.Body,null,r.a.createElement(C.a,null,r.a.createElement(L.a,null,r.a.createElement("a",{href:"/post/".concat(e.id)},r.a.createElement(T.a.Title,null,e.data.title)),r.a.createElement(T.a.Subtitle,null,function(){var t,a=null===(t=e.data.channels)||void 0===t?void 0:t.map((function(t){return r.a.createElement("p",{key:t},0==e.data.channels.indexOf(t)?"#".concat(t):", #".concat(t))}));return r.a.createElement("div",null,r.a.createElement(C.a,{style:{marginLeft:1}},a))}()),r.a.createElement(T.a.Text,{className:Y.a.fontLess}," ",e.data.desc)),r.a.createElement(L.a,{xs:3,sm:2,style:{textAlign:"center"}},r.a.createElement(B.a,{disabled:!a.auth,size:"sm",active:U.includes(e.id),variant:"outline-primary",onClick:function(){We(!0,e),oe(!re)}},"\u25b2"),r.a.createElement("p",null,e.data.upvotes?e.data.upvotes:0),r.a.createElement(B.a,{disabled:!a.auth,size:"sm",active:J.includes(e.id),variant:"outline-danger",onClick:function(){We(!1,e),oe(!re)}},"\u25bc"))),r.a.createElement(T.a.Text,{className:Y.a.fontLess},1==e.numComments?r.a.createElement("a",{href:"/post/".concat(e.id)},e.numComments," comment"):r.a.createElement("a",{href:"/post/".concat(e.id)},e.numComments," comments")," "," - posted by ",r.a.createElement("a",{href:"/user/".concat(e.data.authorName)},"@".concat(e.data.authorName))," - ",n)))}(e))})),r.a.createElement(B.a,{variant:"light",onClick:function(){Fe(ze,h,Ne,Oe)}},"Load more")):xe?r.a.createElement("h3",{style:{paddingTop:15}},"No posts."):r.a.createElement("div",{style:{marginTop:15}},r.a.createElement(_.a,{style:{marginTop:30,marginLeft:30},animation:"border"}))):r.a.createElement(M.a,{className:Y.a.paddingTop},r.a.createElement("h1",null,"User does not exist.")))},J=a(89),X=a.n(J),Z=function(){var e=y(),t=D(),a=Object(n.useState)(!1),o=Object(u.a)(a,2),c=o[0],l=o[1],d=Object(n.useState)(""),m=Object(u.a)(d,2),p=m[0],v=m[1],h=Object(n.useState)(""),f=Object(u.a)(h,2),g=f[0],b=f[1],E=Object(n.useState)(""),O=Object(u.a)(E,2),j=O[0],k=O[1],x=Object(n.useState)(""),w=Object(u.a)(x,2),C=w[0],T=w[1],L=Object(n.useState)(""),N=Object(u.a)(L,2),P=N[0],z=N[1],G=Object(n.useState)(""),H=Object(u.a)(G,2),q=H[0],F=H[1],W=Object(n.useState)(!1),U=Object(u.a)(W,2),K=U[0],Q=U[1],Y=Object(n.useState)(!1),V=Object(u.a)(Y,2),J=V[0],Z=V[1];Object(n.useEffect)((function(){t.auth&&0==J&&(window.location.href="/")}),[t,e]);var $=function(){var e=Object(s.a)(i.a.mark((function e(t){var a,n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),Z(!0),console.log("name = ",p),console.log("username = ",g),console.log("email = ",j),console.log("password = ",C),console.log(t.currentTarget),!(!1===t.currentTarget.checkValidity()||!1===K||q.length>0)){e.next=13;break}console.log(c),t.preventDefault(),t.stopPropagation(),e.next=37;break;case 13:return e.next=15,ee(g);case 15:if(!(e.sent>0)){e.next=20;break}F("Already taken."),e.next=37;break;case 20:return e.prev=20,console.log("this is triggered"),e.next=24,Object(S.auth)().createUserWithEmailAndPassword(j,C).catch((function(e){console.log(e)}));case 24:if(!(a=e.sent)){e.next=30;break}return console.log("this is triggered 2"),r=null===a||void 0===a||null===(n=a.user)||void 0===n?void 0:n.uid,e.next=30,Object(S.firestore)().collection("users").doc(r).set({name:p,username:g,actives:{Arts:!1,Biology:!1,Business:!1,"Computer Science":!1,Economics:!1,Finance:!1,French:!1,General:!0,Humanities:!1,"Languages (General)":!1,Mandarin:!1,Psychology:!1,Spanish:!1,bulletin:!0},upvoted:[],downvoted:[],credits:25}).then((function(){window.location.href="/user/".concat(g)}));case 30:l(!0),e.next=37;break;case 33:e.prev=33,e.t0=e.catch(20),console.log(e.t0),z(e.t0.message);case 37:Z(!1);case 38:case"end":return e.stop()}}),e,null,[[20,33]])})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(s.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(S.firestore)().collection("users").where("username","==",t).limit(1).get();case 2:return a=e.sent,e.abrupt("return",a.size);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement(I.a,{bg:"light",variant:"light"},r.a.createElement(I.a.Brand,{href:"/"}," ","ioyou"),r.a.createElement(R.a,{className:"ml-auto"}),r.a.createElement(B.a,{variant:"outline-dark"},"log in")),r.a.createElement(M.a,{className:X.a.paddingTop,style:{paddingBottom:10}},r.a.createElement(A.a,{validated:c,onSubmit:$},r.a.createElement(A.a.Group,{controlId:"formBasicName"},r.a.createElement(A.a.Label,null,"Name"),r.a.createElement(A.a.Control,{required:!0,type:"text",placeholder:"Jane Doe",onChange:function(e){v(e.target.value)},value:p}),r.a.createElement(A.a.Control.Feedback,{type:"invalid"},"Please provide a name.")),r.a.createElement(A.a.Group,{controlId:"formBasicName"},r.a.createElement(A.a.Label,null,"Username"),r.a.createElement(A.a.Control,{required:!0,type:"text",placeholder:"username",onChange:function(e){b(e.target.value),e.target.value.length>15?F("Too long. Usernames should be < 15 characters."):F("")},value:g}),r.a.createElement(A.a.Text,{className:"text-danger"},q)),r.a.createElement(A.a.Group,{controlId:"formBasicEmail"},r.a.createElement(A.a.Label,null,"Email address"),r.a.createElement(A.a.Control,{required:!0,type:"email",placeholder:"jdoe@email.com",onChange:function(e){k(e.target.value)},value:j}),r.a.createElement(A.a.Control.Feedback,{type:"invalid"},"Please provide an email.")),r.a.createElement(A.a.Group,{controlId:"formBasicPassword"},r.a.createElement(A.a.Label,null,"Password"),r.a.createElement(A.a.Control,{required:!0,type:"password",placeholder:"Password",onChange:function(e){T(e.target.value),e.target.value.match(/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\s).{8,30}$/)?(Q(!0),console.log("passCheck")):(Q(!1),console.log("failCheck"))},value:C}),K?r.a.createElement(A.a.Text,{className:"text-success"},"Looks good!"):r.a.createElement(A.a.Text,{className:"text-danger"},"At least 8 characters and contain an uppercase letter, lowercase letter, number, and special character.")),r.a.createElement(A.a.Group,{controlId:"formBasicCheckbox"},r.a.createElement(A.a.Check,{required:!0,type:"checkbox",label:"I agree to the terms and conditions."})),J?r.a.createElement(B.a,{variant:"primary",disabled:!0},r.a.createElement(_.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})):r.a.createElement(B.a,{variant:"primary",type:"submit"},"Submit")),r.a.createElement("p",{className:"text-danger"},P)))},$=a(90),ee=a.n($),te=function(){var e=y(),t=D(),a=Object(n.useState)(!1),o=Object(u.a)(a,2),c=o[0],l=o[1],d=Object(n.useState)(""),m=Object(u.a)(d,2),p=m[0],v=m[1],h=Object(n.useState)(""),f=Object(u.a)(h,2),g=f[0],b=f[1],E=Object(n.useState)(""),O=Object(u.a)(E,2),j=O[0],k=O[1],x=Object(n.useState)(!1),w=Object(u.a)(x,2),S=w[0],C=w[1];Object(n.useEffect)((function(){t.auth&&c&&(window.location.href="/")}),[t,e]);var T=function(){var t=Object(s.a)(i.a.mark((function t(a){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),C(!0),console.log("email = ",p),console.log("password = ",g),console.log(a.currentTarget),!1!==a.currentTarget.checkValidity()){t.next=11;break}console.log(c),a.preventDefault(),a.stopPropagation(),t.next=23;break;case 11:return t.prev=11,t.next=14,e.doSignInWithEmailAndPassword(p,g);case 14:l(!0),window.location.href="/",t.next=23;break;case 18:t.prev=18,t.t0=t.catch(11),console.log(t.t0),k(t.t0.message),C(!1);case 23:console.log(c);case 24:case"end":return t.stop()}}),t,null,[[11,18]])})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement(I.a,{bg:"light",variant:"light"},r.a.createElement(I.a.Brand,{href:"/"}," ","ioyou"),r.a.createElement(R.a,{className:"ml-auto"},r.a.createElement(B.a,{variant:"outline-dark",href:"/signup"},"sign up"))),r.a.createElement(M.a,{className:ee.a.paddingTop},r.a.createElement(A.a,{validated:c,onSubmit:T},r.a.createElement(A.a.Group,{controlId:"formBasicEmail"},r.a.createElement(A.a.Label,null,"Email address"),r.a.createElement(A.a.Control,{required:!0,type:"email",placeholder:"Enter email",onChange:function(e){v(e.target.value)},value:p})),r.a.createElement(A.a.Group,{controlId:"formBasicPassword"},r.a.createElement(A.a.Label,null,"Password"),r.a.createElement(A.a.Control,{required:!0,type:"password",placeholder:"Password",onChange:function(e){b(e.target.value)},value:g})),S?r.a.createElement(B.a,{variant:"primary",disabled:!0},r.a.createElement(_.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})):r.a.createElement(B.a,{variant:"primary",type:"submit",style:{marginTop:10}},"Log in")),r.a.createElement("p",{className:"text-danger"},j)))},ae=a(129),ne=a(91),re=a.n(ne),oe=function(){var e=y(),t=D(),a=Object(n.useState)([]),o=Object(u.a)(a,2),c=o[0],l=o[1],d=Object(n.useState)([]),m=Object(u.a)(d,2),p=m[0],v=m[1],h=Object(n.useState)(["Arts","Business","Computer Science","Economics","Finance","History","Humanities","French","Mandarin","Spanish","Languages (General)","Mathematics","Biology","Chemistry","Physics","Sciences (General)","Psychology","Sociology","Social Sciences (General)","General"]),f=Object(u.a)(h,2),g=f[0],b=(f[1],Object(n.useState)("")),O=Object(u.a)(b,2),j=O[0],k=O[1],x=Object(n.useState)(""),w=Object(u.a)(x,2),T=w[0],L=w[1],N=Object(n.useState)(0),P=Object(u.a)(N,2),z=P[0],G=P[1],H=Object(n.useState)(!1),q=Object(u.a)(H,2),F=q[0],W=q[1],U=Object(n.useState)(""),K=Object(u.a)(U,2),Q=K[0],Y=K[1],V=Object(n.useState)(""),J=Object(u.a)(V,2),X=J[0],Z=J[1],$=Object(n.useState)(!1),ee=Object(u.a)($,2),te=ee[0],ne=ee[1],oe=Object(n.useState)(""),ce=Object(u.a)(oe,2),le=ce[0],ie=ce[1],se=Object(n.useState)(""),ue=Object(u.a)(se,2),de=ue[0],me=ue[1],pe=Object(n.useState)(null),ve=Object(u.a)(pe,2),he=ve[0],fe=ve[1],ge=Object(n.useState)(!1),be=Object(u.a)(ge,2),Ee=be[0],Oe=be[1];Object(n.useEffect)((function(){t.auth?function(){var e=Object(s.a)(i.a.mark((function e(){var a,n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(S.firestore)().collection("users").doc(null===(a=t.auth)||void 0===a?void 0:a.uid).get();case 2:r=e.sent,me(null===(n=r.data())||void 0===n?void 0:n.username),fe(r.data());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()():window.location.href="/"}),[t,e]);var ye=function(){var a=Object(s.a)(i.a.mark((function a(n){var r,o,l,s,u;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(ne(!0),n.preventDefault(),console.log(j),console.log(T),o=null,!Ee){a.next=9;break}o={title:j,desc:T,timestamp:S.firestore.Timestamp.now(),author:null===t||void 0===t||null===(l=t.auth)||void 0===l?void 0:l.uid,channels:[],authorName:de,bulletin:Ee,upvotes:0,bounty:Number(z),awarded:!0},a.next=18;break;case 9:if(!(0==z||0==F||z>he.credits)){a.next=17;break}return n.preventDefault(),n.stopPropagation(),ne(!1),z>he.credits&&Z("You have ".concat(he.credits," credit(s) left.")),a.abrupt("return");case 17:o=0==c.length?{title:j,desc:T,timestamp:S.firestore.Timestamp.now(),author:null===t||void 0===t||null===(s=t.auth)||void 0===s?void 0:s.uid,channels:["General"],authorName:de,bulletin:!1,upvotes:0,bounty:Number(z),awarded:!1}:{title:j,desc:T,timestamp:S.firestore.Timestamp.now(),author:null===t||void 0===t||null===(u=t.auth)||void 0===u?void 0:u.uid,channels:c,authorName:de,upvotes:0,bulletin:!1,bounty:Number(z),awarded:!1};case 18:return a.next=20,Object(S.functions)().httpsCallable("createPost")(o);case 20:return a.next=22,e.db.collection("users").doc(null===t||void 0===t||null===(r=t.auth)||void 0===r?void 0:r.uid).update({credits:he.credits-z});case 22:window.location.href="/";case 23:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement(I.a,{bg:"light",variant:"light"},r.a.createElement(I.a.Brand,{href:"/"}," ","ioyou"),r.a.createElement(R.a,{className:"ml-auto"},r.a.createElement(B.a,{variant:"light",onClick:Object(s.a)(i.a.mark((function a(){var n,r,o,c;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.db.collection("users").doc(null===t||void 0===t||null===(n=t.auth)||void 0===n?void 0:n.uid).get();case 2:o=a.sent,c=null===o||void 0===o||null===(r=o.data())||void 0===r?void 0:r.username,window.location.href="/user/".concat(c);case 5:case"end":return a.stop()}}),a)}))),style:{marginRight:10}},"Profile"),r.a.createElement(B.a,{variant:"light",onClick:function(){window.location.reload(),e.doSignOut()}},"Sign Out"))),r.a.createElement(M.a,{className:re.a.paddingTop},r.a.createElement("div",null,r.a.createElement("h1",{style:{paddingBottom:15}},"Create a new post"),r.a.createElement(A.a,{onSubmit:ye},r.a.createElement(ae.a,{style:{paddingBottom:15}},r.a.createElement(B.a,{variant:"outline-primary",active:!Ee,onClick:function(){Oe(!1)}},"Academic"),r.a.createElement(B.a,{variant:"outline-primary",active:Ee,onClick:function(){Oe(!0)}},"Bulletin")),Ee?r.a.createElement("div",null):r.a.createElement(A.a.Group,{controlId:"channels"},r.a.createElement(A.a.Label,null,"Channels"),r.a.createElement(C.a,{style:{marginLeft:10}},function(){var e=c.map((function(e){return r.a.createElement(B.a,{variant:"dark",key:e,style:{marginRight:15,marginBottom:15},onClick:function(){var t=Object(E.a)(c),a=t.indexOf(e);-1!==a&&(t.splice(a,1),l(t)),c.length<11&&Y("")}},e)}));return r.a.createElement("div",null,e)}(),function(){var e=p.map((function(e){return r.a.createElement(B.a,{variant:"outline-dark",key:e,style:{marginRight:15,marginBottom:15},onClick:function(){if(c.length>9)Y("Maximum 10 channels");else{if(Y(""),ie(""),v([]),-1!=c.indexOf(e))return;l([].concat(Object(E.a)(c),[e]))}}},e)}));return r.a.createElement("div",null,e)}()),r.a.createElement(A.a.Control,{type:"text",placeholder:c.length>0?"Add additional subjects if necessary.":"What subjects?",onChange:function(e){if(ie(e.target.value),e.target.value.length>0){for(var t=e.target.value,a=[],n=0;n<g.length;n++)g[n].replace(/[^a-zA-Z0-9]/g,"").substr(0,t.length).toLowerCase()==t.toLowerCase()&&a.push(g[n]);v(a)}else v([])},onBlur:function(){1==p.length&&(l([].concat(Object(E.a)(c),Object(E.a)(p))),ie(""),v([]))},value:le}),r.a.createElement(A.a.Text,{className:"text-danger"},Q)),r.a.createElement(A.a.Group,{controlId:"title"},r.a.createElement(A.a.Label,null,"Title"),r.a.createElement(A.a.Control,{required:!0,type:"text",placeholder:"What's up?",onChange:function(e){k(e.target.value)}})),r.a.createElement(A.a.Group,{controlId:"description"},r.a.createElement(A.a.Label,null,"Description"),r.a.createElement(A.a.Control,{as:"textarea",rows:3,placeholder:"Add more details if necessary.",onChange:function(e){L(e.target.value)}})),Ee?r.a.createElement("div",null):r.a.createElement(A.a.Group,{controlId:"bounty"},r.a.createElement(A.a.Label,null,"Bounty"),r.a.createElement(A.a.Control,{required:!0,as:"input",placeholder:"Credits",onChange:function(e){G(e.target.value),e.target.value.match(/^[0-9\b]+$/)?(W(!0),console.log("passCheck")):(W(!1),console.log("failCheck"))},value:z}),z>0&&1==F?z>he.credits?r.a.createElement(A.a.Text,{className:"text-danger"},X):r.a.createElement(A.a.Text,{className:"text-success"},"Looks good!"):r.a.createElement(A.a.Text,{className:"text-danger"},"At least 1 credit must be posted.")),te?r.a.createElement(B.a,{variant:"primary",disabled:!0,style:{marginTop:15}},r.a.createElement(_.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})):r.a.createElement(B.a,{variant:"primary",type:"submit",style:{marginTop:15}},"Post"),function(){var e=c.map((function(e){return r.a.createElement("p",{key:e},0==c.indexOf(e)?"to ".concat(e):", ".concat(e))}));return r.a.createElement(C.a,{style:{marginTop:15,marginLeft:15}},e)}()))))},ce=a(31),le=a.n(ce),ie=function(e){var t=y(),a=D(),o=Object(m.f)().postid,c=Object(n.useState)(null),l=Object(u.a)(c,2),d=l[0],p=l[1],v=Object(n.useState)(null),h=Object(u.a)(v,2),f=h[0],g=h[1],b=Object(n.useState)(!1),O=Object(u.a)(b,2),j=O[0],k=O[1],x=Object(n.useState)(""),w=Object(u.a)(x,2),N=w[0],P=w[1],H=Object(n.useState)(void 0),q=Object(u.a)(H,2),F=q[0],W=q[1],U=Object(n.useState)(0),K=Object(u.a)(U,2),Q=K[0],Y=K[1],V=Object(n.useState)(!1),J=Object(u.a)(V,2),X=J[0],Z=J[1],$=Object(n.useState)(!1),ee=Object(u.a)($,2),te=ee[0],ae=ee[1],ne=Object(n.useState)(!1),re=Object(u.a)(ne,2),oe=re[0],ce=re[1],ie=Object(n.useState)(!1),se=Object(u.a)(ie,2),ue=se[0],de=se[1],me=Object(n.useState)(0),pe=Object(u.a)(me,2),ve=pe[0],he=pe[1],fe=Object(n.useState)(""),ge=Object(u.a)(fe,2),be=ge[0],Ee=ge[1],Oe=Object(n.useState)(""),ye=Object(u.a)(Oe,2),je=ye[0],ke=ye[1],xe=Object(n.useState)(""),we=Object(u.a)(xe,2),Se=we[0],Ce=we[1],Te=Object(n.useState)(!1),Le=Object(u.a)(Te,2),Be=Le[0],_e=Le[1],Ne=Object(n.useState)(!1),Pe=Object(u.a)(Ne,2),Ie=Pe[0],Re=Pe[1],ze=Object(n.useState)([]),Ge=Object(u.a)(ze,2),Ae=Ge[0],Me=Ge[1],He=Object(n.useState)([]),qe=Object(u.a)(He,2),Fe=qe[0],De=qe[1],We=Object(n.useState)(!1),Ue=Object(u.a)(We,2),Ke=Ue[0],Qe=Ue[1],Ye=Object(n.useState)(0),Ve=Object(u.a)(Ye,2),Je=Ve[0],Xe=Ve[1],Ze=Object(n.useState)(!1),$e=Object(u.a)(Ze,2),et=$e[0],tt=$e[1],at=Object(n.useState)(!1),nt=Object(u.a)(at,2),rt=nt[0],ot=nt[1],ct=Object(n.useState)(""),lt=Object(u.a)(ct,2),it=lt[0],st=lt[1],ut=Object(n.useState)(""),dt=Object(u.a)(ut,2),mt=dt[0],pt=dt[1],vt=Object(n.useState)(""),ht=Object(u.a)(vt,2),ft=ht[0],gt=ht[1],bt=Object(n.useState)(""),Et=Object(u.a)(bt,2),Ot=Et[0],yt=Et[1],jt=Object(n.useState)(!1),kt=Object(u.a)(jt,2),xt=kt[0],wt=kt[1],St=Object(n.useState)(!1),Ct=Object(u.a)(St,2),Tt=Ct[0],Lt=Ct[1],Bt=Object(n.useState)(!1),_t=Object(u.a)(Bt,2),Nt=_t[0],Pt=_t[1],It=Object(n.useState)(""),Rt=Object(u.a)(It,2),zt=Rt[0],Gt=Rt[1],At=Object(n.useState)(""),Mt=Object(u.a)(At,2),Ht=Mt[0],qt=Mt[1],Ft=Object(n.useState)(""),Dt=Object(u.a)(Ft,2),Wt=Dt[0],Ut=Dt[1],Kt=function(){var e=Object(s.a)(i.a.mark((function e(a){var n,r,o,c,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=[],e.next=4,t.db.collection("comments").where("parent","==",a).orderBy("upvotes","desc").limit(10).get();case 4:if(r=e.sent,console.log("commentsList = ",r),!r.empty&&null!=r){e.next=10;break}return console.log("No matching documents"),ce(!0),e.abrupt("return");case 10:r.forEach((function(e){n=[].concat(Object(E.a)(n),[{id:e.id,data:e.data()}])})),o=0;case 12:if(!(o<n.length)){e.next=21;break}return c=n[o],e.next=16,Kt(c.id);case 16:l=e.sent,n[o]={id:c.id,data:c.data,replies:l};case 18:o++,e.next=12;break;case 21:return e.abrupt("return",n);case 24:e.prev=24,e.t0=e.catch(0),console.log(e.t0);case 27:case"end":return e.stop()}}),e,null,[[0,24]])})));return function(t){return e.apply(this,arguments)}}(),Qt=function(e,n){var r="comments";n==f&&(n={data:f,id:o},r="posts");var c,l=[],i=[],s=-1,u=-1;if(console.log("userDoc = ",d),d.upvoted&&(s=(l=Ae).indexOf(n.id)),d.downvoted&&(u=(i=Fe).indexOf(n.id)),console.log("upvoteIndex = ",s),console.log("upvoteList = ",l),console.log("downvoteIndex = ",u),console.log("downvoteList = ",i),c=n.data.upvotes?n.data.upvotes:0,e){var m;if(-1==s){var p;if(-1!=u)i.splice(u,1),t.db.collection("users").doc(null===(p=a.auth)||void 0===p?void 0:p.uid).update({downvoted:i}),c+=1;l=[].concat(Object(E.a)(l),[n.id]),console.log("upvoteList after adding = ",l),c+=1}else l.splice(s,1),console.log("upvoteList after splice = ",l),c-=1;t.db.collection("users").doc(null===(m=a.auth)||void 0===m?void 0:m.uid).update({upvoted:l}),t.db.collection(r).doc(n.id).update({upvotes:c}),n.data.upvotes=c}else{var v;if(-1==u){var h;if(-1!=s)l.splice(s,1),t.db.collection("users").doc(null===(h=a.auth)||void 0===h?void 0:h.uid).update({upvoted:l}),c-=1;i=[].concat(Object(E.a)(i),[n.id]),console.log("downvoteList after adding = ",i),c-=1}else i.splice(u,1),console.log("downvoteList after splice = ",i),c+=1;t.db.collection("users").doc(null===(v=a.auth)||void 0===v?void 0:v.uid).update({downvoted:i}),t.db.collection(r).doc(n.id).update({upvotes:c}),n.data.upvotes=c}l&&Me(l),i&&De(i)};Object(n.useEffect)((function(){(function(){var e=Object(s.a)(i.a.mark((function e(){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.db.collection("comments").where("thread","==",o).get();case 2:a=e.sent,Y(a.size);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()();var e=.001*(new Date).getTime()>>0;(he(e),a.auth)&&function(){var e=Object(s.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(S.firestore)().collection("users").doc(null===(t=a.auth)||void 0===t?void 0:t.uid).get();case 2:return e.next=4,e.sent.data();case 4:n=e.sent,p(n),(null===n||void 0===n?void 0:n.upvoted)&&Me(null===n||void 0===n?void 0:n.upvoted),(null===n||void 0===n?void 0:n.downvoted)&&De(null===n||void 0===n?void 0:n.downvoted);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()();(function(){var t=Object(s.a)(i.a.mark((function t(){var n,r,c,l,s,u,d;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(S.firestore)().collection("posts").doc(o).get();case 3:return t.next=5,t.sent.data();case 5:return r=t.sent,console.log("postDoc = ",r),r&&(c=e-(null===r||void 0===r?void 0:r.timestamp.seconds),console.log("time = ",c),l="",c<120?l="about a minute ago":c<3600?l="".concat(Math.floor(c/60)," minutes ago"):c<86400?(s=Math.floor(c/3600),l=1==s?"about an hour ago":"".concat(s," hours ago")):(u=Math.floor(c/86400),l=1==u?"yesterday":"".concat(u," days ago")),Ee(l)),g(r),(null===r||void 0===r?void 0:r.author)==(null===a||void 0===a||null===(n=a.auth)||void 0===n?void 0:n.uid)&&k(!0),t.next=12,Kt(o);case 12:d=t.sent,console.log(d),W(d),ce(!0),ae(!0),t.next=23;break;case 19:t.prev=19,t.t0=t.catch(0),console.log(t.t0),ae(!0);case 23:case"end":return t.stop()}}),t,null,[[0,19]])})));return function(){return t.apply(this,arguments)}})()()}),[a,t]);var Yt=function(e){Ce(e.target.value)},Vt=function(){var e=Object(s.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),_e(!0),console.log(Se),r={comment:Se,parent:je,thread:o,timestamp:S.firestore.Timestamp.now(),author:null===a||void 0===a||null===(n=a.auth)||void 0===n?void 0:n.uid,authorName:d.username,upvotes:0,selected:0},e.next=6,Object(S.functions)().httpsCallable("createComment")(r).then(Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=W,e.next=3,Kt(o);case 3:e.t1=e.sent,(0,e.t0)(e.t1),Y(Q+1),ce(!0),_e(!1),ke("");case 9:case"end":return e.stop()}}),e)}))));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Jt=function(){var e=Object(s.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),de(!0),console.log(N),r={comment:N,parent:o,thread:o,timestamp:S.firestore.Timestamp.now(),author:null===a||void 0===a||null===(n=a.auth)||void 0===n?void 0:n.uid,authorName:d.username,upvotes:0,selected:0},e.next=6,Object(S.functions)().httpsCallable("createComment")(r).then(Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=W,e.next=3,Kt(o);case 3:e.t1=e.sent,(0,e.t0)(e.t1),Y(Q+1),ce(!0),de(!1),Z(!1);case 9:case"end":return e.stop()}}),e)}))));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Xt=function(e){var t,n=ve-e.data.timestamp.seconds,o="";if(n<120)o="about a minute ago";else if(n<3600)o="".concat(Math.floor(n/60)," minutes ago");else if(n<86400){var c=Math.floor(n/3600);o=1==c?"about an hour ago":"".concat(c," hours ago")}else{var l=Math.floor(n/86400);o=1==l?"yesterday":"".concat(l," days ago")}return r.a.createElement("div",{className:le.a.borderLeft,style:{marginBottom:10,paddingLeft:10,paddingTop:10}},e.data.selected>0?r.a.createElement(C.a,null,r.a.createElement(L.a,null,r.a.createElement("p",{style:{fontSize:20}},"@".concat(e.data.authorName)),r.a.createElement("p",{className:le.a.fontLess}," ",e.data.comment)),r.a.createElement(L.a,{xs:3,md:2},r.a.createElement(B.a,{variant:"success",size:"sm"},e.data.selected," cr."))):j?r.a.createElement(C.a,null,r.a.createElement(L.a,null,r.a.createElement("p",{style:{fontSize:20}},"@".concat(e.data.authorName)),r.a.createElement("p",{className:le.a.fontLess}," ",e.data.comment)),r.a.createElement(L.a,{xs:3,md:2},r.a.createElement(B.a,{variant:"primary",size:"sm",onClick:function(){Gt(e.data.authorName),qt(e.data.author),Ut(e.id),Qe(!0)}},"Award"))):r.a.createElement("div",null,r.a.createElement("p",{style:{fontSize:20}},"@".concat(e.data.authorName)),r.a.createElement("p",{className:le.a.fontLess}," ",e.data.comment)),r.a.createElement("p",{className:le.a.fontLess},r.a.createElement(B.a,{disabled:!a.auth,active:Ae.includes(e.id),size:"sm",variant:"outline-dark",onClick:function(){Qt(!0,e),Re(!Ie)}},"\u25b2")," ","\xa0",(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.upvotes)?e.data.upvotes:0," ","\xa0",r.a.createElement(B.a,{disabled:!a.auth,active:Fe.includes(e.id),size:"sm",variant:"outline-dark",onClick:function(){Qt(!1,e),Re(!Ie)}},"\u25bc")," - ",r.a.createElement(B.a,{variant:"light",size:"sm",onClick:function(){ke(e.id)}},"Reply")," "," - ",o," - ","\xa0",r.a.createElement(B.a,{disabled:!a.auth,size:"sm",variant:"outline-danger",onClick:function(){gt(e.data.authorName),yt(e.id),Pt(!0)}},"\u2690")),je==e.id?r.a.createElement(T.a,null,r.a.createElement(T.a.Body,null,r.a.createElement(A.a,{onSubmit:Vt},r.a.createElement(A.a.Group,{controlId:"description"},r.a.createElement(A.a.Control,{required:!0,as:"textarea",rows:3,placeholder:"Replying to @".concat(e.data.authorName,"..."),onChange:Yt})),Be?r.a.createElement(B.a,{variant:"primary",style:{marginTop:15}},r.a.createElement(_.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})):r.a.createElement(B.a,{variant:"primary",type:"submit",style:{marginTop:15}},"Reply")))):r.a.createElement("div",null),e.replies&&e.replies.length>0?Zt(e.replies):r.a.createElement("div",null))},Zt=function(e){return e.map((function(e){return r.a.createElement("div",{key:e.id,style:{paddingTop:15}},Xt(e))}))};return r.a.createElement("div",null,r.a.createElement(I.a,{bg:"light",variant:"light"},r.a.createElement(I.a.Brand,{href:"/"}," ","ioyou"),r.a.createElement(R.a,{className:"ml-auto"},a.auth?r.a.createElement("div",null,r.a.createElement(B.a,{variant:"light",onClick:Object(s.a)(i.a.mark((function e(){var n,r,o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.db.collection("users").doc(null===a||void 0===a||null===(n=a.auth)||void 0===n?void 0:n.uid).get();case 2:o=e.sent,c=null===o||void 0===o||null===(r=o.data())||void 0===r?void 0:r.username,window.location.href="/user/".concat(c);case 5:case"end":return e.stop()}}),e)}))),style:{marginRight:10}},"Profile"),r.a.createElement(B.a,{href:"/new",variant:"outline-dark",style:{marginRight:10}},"Post"),r.a.createElement(B.a,{variant:"outline-dark",onClick:function(){window.location.reload(),t.doSignOut()}},"Sign Out")):r.a.createElement("div",null,r.a.createElement(B.a,{variant:"outline-dark",href:"/login",style:{marginRight:10}},"log in"),r.a.createElement(B.a,{variant:"light",href:"/signup"},"sign up")))),r.a.createElement(z.a,{show:Ke,onHide:function(){Qe(!1)}},r.a.createElement(z.a.Header,{closeButton:!0},r.a.createElement(z.a.Title,null,"Award @",zt,"!")),r.a.createElement(z.a.Body,null,"Awards cannot be taken back once submitted."),r.a.createElement(z.a.Footer,null,r.a.createElement(G.a,null,r.a.createElement(A.a.Control,{placeholder:"How many credits?",onChange:function(e){Xe(e.target.value),e.target.value.match(/^[0-9\b]+$/)?(tt(!0),console.log("passCheck")):(tt(!1),console.log("failCheck"))},value:Je}),r.a.createElement(A.a.Text,null,it)),rt?r.a.createElement(B.a,{disabled:!0},r.a.createElement(_.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})):r.a.createElement(B.a,{onClick:function(){console.log("award = ",Je),Je>Number(f.bounty)+Number(d.credits)?st("You have ".concat(Number(f.bounty)+Number(d.credits)," credits to give.")):0==et||Je<1?st("Input at least 1 credit."):(ot(!0),Object(S.functions)().httpsCallable("chooseAwardCredits")({author:Ht,bounty:Number(f.bounty),post:o,comment:Wt,award:Number(Je)}).then((function(){Qe(!1),window.location.reload()})))}},"Award"))),r.a.createElement(z.a,{show:Nt,onHide:function(){Pt(!1),Lt(!1),pt("")}},r.a.createElement(z.a.Header,{closeButton:!0},r.a.createElement(z.a.Title,null,"Report @",ft)),r.a.createElement(z.a.Body,null,"Let us know if this user is violating community agreements as outlined in our terms of service. Thanks!"),r.a.createElement(z.a.Footer,null,r.a.createElement(G.a,null,r.a.createElement(A.a.Control,{as:"textarea",placeholder:"What's the reason for reporting this user?",rows:3,onChange:function(e){pt(e.target.value)},value:mt})),xt?r.a.createElement(B.a,{disabled:!0,variant:"danger"},r.a.createElement(_.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})):Tt?r.a.createElement(B.a,{disabled:!0,variant:"danger"},"Thanks! You can close this window."):r.a.createElement(B.a,{variant:"danger",onClick:Object(s.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return wt(!0),e.next=3,Object(S.functions)().httpsCallable("createReport")({post:Ot,reportMessage:mt,submittedBy:null===(t=a.auth)||void 0===t?void 0:t.uid,timestamp:S.firestore.Timestamp.now()}).then((function(){wt(!1),Lt(!0)}));case 3:case"end":return e.stop()}}),e)})))},"Report"))),f?r.a.createElement(M.a,{className:le.a.paddingTop},r.a.createElement(T.a,{style:{marginBottom:30}},r.a.createElement(T.a.Body,null,r.a.createElement(C.a,null,r.a.createElement(L.a,null,r.a.createElement(T.a.Title,null,null===f||void 0===f?void 0:f.title),r.a.createElement(T.a.Subtitle,null,function(e){var t,a=null===(t=e.channels)||void 0===t?void 0:t.map((function(t){return r.a.createElement("p",{key:t},0==e.channels.indexOf(t)?"#".concat(t):", #".concat(t))}));return r.a.createElement("div",null,r.a.createElement(C.a,{style:{marginLeft:1}},a))}(f)),r.a.createElement(T.a.Text,null,null===f||void 0===f?void 0:f.desc)),r.a.createElement(L.a,{xs:3,sm:2,style:{textAlign:"center"}},r.a.createElement(B.a,{disabled:!a.auth,active:Ae.includes(o),size:"sm",variant:"outline-primary",onClick:function(){Qt(!0,f),Re(!Ie)}},"\u25b2"),r.a.createElement("p",null,(null===f||void 0===f?void 0:f.upvotes)?null===f||void 0===f?void 0:f.upvotes:0),r.a.createElement(B.a,{disabled:!a.auth,active:Fe.includes(o),size:"sm",variant:"outline-danger",onClick:function(){Qt(!1,f),Re(!Ie)}},"\u25bc"),r.a.createElement(T.a,{bg:"light",style:{marginTop:15}},(null===f||void 0===f?void 0:f.bounty)<=0?r.a.createElement(T.a.Title,{style:{paddingTop:10}},"Claimed"):r.a.createElement(T.a.Title,{style:{paddingTop:10}},null===f||void 0===f?void 0:f.bounty," cr.")))),r.a.createElement(T.a.Text,{className:le.a.fontLess,style:{paddingTop:10}},"Posted by ",r.a.createElement("a",{href:"/user/".concat(null===f||void 0===f?void 0:f.authorName)},"@".concat(null===f||void 0===f?void 0:f.authorName))," ",be," - ","\xa0",r.a.createElement(B.a,{disabled:!a.auth,size:"sm",variant:"outline-danger",onClick:function(){gt(f.authorName),yt(o),Pt(!0)}},"\u2690")))),a.auth?X?r.a.createElement(A.a,{onSubmit:Jt},r.a.createElement(A.a.Group,{controlId:"description"},r.a.createElement(A.a.Label,null,"Answer"),r.a.createElement(A.a.Control,{required:!0,as:"textarea",rows:3,placeholder:"",onChange:function(e){P(e.target.value)}})),ue?r.a.createElement(B.a,{variant:"primary",style:{marginTop:15}},r.a.createElement(_.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})):r.a.createElement(B.a,{variant:"primary",type:"submit",style:{marginTop:15}},"Comment")):r.a.createElement(B.a,{variant:"primary",onClick:function(){Z(!0)}},"Comment"):r.a.createElement("div",null),r.a.createElement("hr",null),F?r.a.createElement("div",null,1==Q?r.a.createElement("h3",{style:{paddingTop:30,paddingLeft:22,paddingBottom:15}},Q," comment"):r.a.createElement("h3",{style:{paddingTop:30,paddingLeft:22,paddingBottom:15}},Q," comments"),Zt(F)):oe?r.a.createElement("div",null,r.a.createElement("h3",{style:{paddingTop:30,paddingLeft:22,paddingBottom:15}},Q," comments")):r.a.createElement(_.a,{style:{marginTop:30,marginLeft:30},animation:"border"})):te?r.a.createElement(M.a,{className:le.a.paddingTop},r.a.createElement("h1",null,"No post found.")):r.a.createElement(M.a,{className:le.a.paddingTop},r.a.createElement(_.a,{style:{marginTop:30,marginLeft:30},animation:"border"})))},se=function(){return D().initializing?r.a.createElement("div",null):r.a.createElement(d.a,null,r.a.createElement(m.c,null,r.a.createElement(m.a,{exact:!0,path:p},r.a.createElement(K,null)),r.a.createElement(m.a,{path:v},r.a.createElement(Z,null)),r.a.createElement(m.a,{path:h},r.a.createElement(te,null)),r.a.createElement(m.a,{path:f},r.a.createElement(oe,null)),r.a.createElement(m.a,{path:g},r.a.createElement(V,null)),r.a.createElement(m.a,{path:b},r.a.createElement(ie,null))))},ue=function(){var e=y(),t=Object(n.useState)((function(){var t=e.auth.currentUser;return t?{initializing:!1,auth:t}:{initializing:!0,auth:null}})),a=Object(u.a)(t,2),o=a[0],c=a[1];return Object(n.useEffect)((function(){var t=e.auth.onAuthStateChanged((function(e){console.log("New user detected in auth onChange: ",e),null===e?(console.log("Not authenticated"),c({initializing:!1,auth:null})):c((function(t){return null===t.auth?(console.log("Authenticated"),{initializing:!1,auth:e}):(console.log("Bug: reauthenticated"),t)}))}));return function(){t()}}),[e.auth]),r.a.createElement(F.Provider,{value:o},r.a.createElement(se,null))},de=function(){var e=y(),t=Object(n.useCallback)(Object(s.a)(i.a.mark((function t(){var a,n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.auth.currentUser){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,e.auth.getRedirectResult();case 5:if(a=t.sent,console.log("Received Redirect result: ",a),n=a.user,a.additionalUserInfo,a.credential,n){t.next=11;break}return console.log("No Twitter Redirect Result!"),t.abrupt("return");case 11:console.log("Current user after redirect: ",e.auth.currentUser),t.next=21;break;case 14:t.prev=14,t.t0=t.catch(2),t.t0.code,t.t0.message,t.t0.email,t.t0.credential,console.log(t.t0);case 21:case"end":return t.stop()}}),t,null,[[2,14]])}))),[e.auth]);return Object(n.useEffect)((function(){console.log("Current user in Twitter Checking Component: ",e.auth.currentUser),t()}),[t,e.auth]),r.a.createElement(ue,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(O.Provider,{value:new function e(){var t=this;Object(j.a)(this,e),this.auth=void 0,this.db=void 0,this.functions=void 0,this.provider=void 0,this.doTwitterSignIn=Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.auth.signInWithRedirect(t.provider);case 1:case"end":return e.stop()}}),e)}))),this.doCreateUserWithEmailAndPassword=function(e,a){return t.auth.createUserWithEmailAndPassword(e,a)},this.doSignInWithEmailAndPassword=function(e,a){return t.auth.signInWithEmailAndPassword(e,a)},this.doSignOut=function(){return t.auth.signOut()},x.a.apps.length||x.a.initializeApp(w),this.auth=x.a.auth(),this.db=x.a.firestore(),this.functions=x.a.functions(),this.provider=new x.a.auth.TwitterAuthProvider}},r.a.createElement(de,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},31:function(e,t,a){e.exports={paddingTop:"Question_paddingTop__3SnTv",centerItems:"Question_centerItems__2niqs",fontLess:"Question_fontLess__1iLQC",opaqueLess:"Question_opaqueLess__2kYLQ",refresh:"Question_refresh__vU4gl",borderLeft:"Question_borderLeft__2Cpjz"}},42:function(e,t,a){e.exports={paddingTop:"Profile_paddingTop__3kNOc",centerItems:"Profile_centerItems__3xB3O",fontLess:"Profile_fontLess__1fK0e",opaqueLess:"Profile_opaqueLess__DR6mh",refresh:"Profile_refresh__Vh51B"}},70:function(e,t,a){e.exports={paddingTop:"Home_paddingTop__lwuR_",centerItems:"Home_centerItems__11x6e",fontLess:"Home_fontLess__3aF4X",opaqueLess:"Home_opaqueLess__1EMYG",refresh:"Home_refresh__2Epj3",aNoStyle:"Home_aNoStyle__3zzT_"}},89:function(e,t,a){e.exports={paddingTop:"Signup_paddingTop__3HXmM",centerItems:"Signup_centerItems__k192t",fontLess:"Signup_fontLess__X2EvG",opaqueLess:"Signup_opaqueLess__1t1Dw",refresh:"Signup_refresh__26-ho",errMessage:"Signup_errMessage__2DZ-o"}},90:function(e,t,a){e.exports={paddingTop:"Login_paddingTop__217cV",centerItems:"Login_centerItems__1sObU",fontLess:"Login_fontLess__30mul",opaqueLess:"Login_opaqueLess__3Bk5N",refresh:"Login_refresh__3VAKS"}},91:function(e,t,a){e.exports={paddingTop:"Post_paddingTop__MEynF",centerItems:"Post_centerItems__2dmyQ",fontLess:"Post_fontLess__hqyhX",opaqueLess:"Post_opaqueLess__1M4G5",refresh:"Post_refresh__1fCFf"}},96:function(e,t,a){e.exports=a(118)}},[[96,1,2]]]);
//# sourceMappingURL=main.96fb11e8.chunk.js.map